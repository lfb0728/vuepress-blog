(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{362:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"git-分支管理策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-分支管理策略"}},[t._v("#")]),t._v(" Git 分支管理策略")]),t._v(" "),a("p",[t._v("通常，合并分支时，如果可能，Git会用"),a("code",[t._v("Fast forward")]),t._v("模式，但这种模式下，删除分支后，会丢掉分支信息。")]),t._v(" "),a("p",[t._v("如果要强制禁用"),a("code",[t._v("Fast forward")]),t._v("模式，Git就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。")]),t._v(" "),a("p",[t._v("下面我们实战一下"),a("code",[t._v("--no-ff")]),t._v("方式的"),a("code",[t._v("git merge")]),t._v("：")]),t._v(" "),a("p",[t._v("首先，仍然创建并切换"),a("code",[t._v("dev")]),t._v("分支：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout -b dev\nSwitched to a new branch "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dev'")]),t._v("\n")])])]),a("p",[t._v("修改"),a("code",[t._v("readme.txt")]),t._v("文件，并提交一个新的commit：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"第五个版本"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("dev 4afe796"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 第五个版本\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("现在，我们切换回"),a("code",[t._v("master")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout master\nSwitched to branch "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'master'")]),t._v("\nYour branch is ahead of "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'origin/master'")]),t._v(" by "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" commits.\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("use "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git push"')]),t._v(" to publish your "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" commits"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("准备合并"),a("code",[t._v("dev")]),t._v("分支，请注意"),a("code",[t._v("--no-ff")]),t._v("参数，表示禁用"),a("code",[t._v("Fast forward")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" merge --no-ff -m "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"merge with no-ff"')]),t._v(" dev\nMerge made by the "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recursive'")]),t._v(" strategy.\n readme.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" +\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("因为本次合并要创建一个新的commit，所以加上"),a("code",[t._v("-m")]),t._v("参数，把commit描述写进去。")]),t._v(" "),a("p",[t._v("合并后，我们用"),a("code",[t._v("git log")]),t._v("看看分支历史：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" log --graph --pretty"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oneline --abbrev-commit\n*   933e165 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" merge with no-ff\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" * 4afe796 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 第五个版本\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("/\n*   bae428b 解决冲突后的第四个版本\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" * 94afac1 第四个版本\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" 23150f2 和第三个版本解决冲突\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("/\n* 894b6e5 第三个版本\n* fb74ee7 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("origin/master, origin/HEAD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n* b516c2e 文件删除版本\n* d6e43ff 第二个版本\n* 685bd3d 第一个版本\n")])])]),a("p",[t._v("可以看到，不使用"),a("code",[t._v("Fast forward")]),t._v("模式，merge后就像这样：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919023225142304/0",alt:"git-no-ff-mode"}})]),t._v(" "),a("h2",{attrs:{id:"分支策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支策略"}},[t._v("#")]),t._v(" 分支策略")]),t._v(" "),a("p",[t._v("在实际开发中，我们应该按照几个基本原则进行分支管理：")]),t._v(" "),a("p",[t._v("首先，"),a("code",[t._v("master")]),t._v("分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活；")]),t._v(" "),a("p",[t._v("那在哪干活呢？干活都在"),a("code",[t._v("dev")]),t._v("分支上，也就是说，"),a("code",[t._v("dev")]),t._v("分支是不稳定的，到某个时候，比如1.0版本发布时，再把"),a("code",[t._v("dev")]),t._v("分支合并到"),a("code",[t._v("master")]),t._v("上，在"),a("code",[t._v("master")]),t._v("分支发布1.0版本；")]),t._v(" "),a("p",[t._v("你和你的小伙伴们每个人都在"),a("code",[t._v("dev")]),t._v("分支上干活，每个人都有自己的分支，时不时地往"),a("code",[t._v("dev")]),t._v("分支上合并就可以了。")]),t._v(" "),a("p",[t._v("所以，团队合作的分支看起来就像这样：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919023260793600/0",alt:"git-br-policy"}})]),t._v(" "),a("p",[t._v("合并分支时，加上"),a("code",[t._v("--no-ff")]),t._v("参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而"),a("code",[t._v("fast forward")]),t._v("合并就看不出来曾经做过合并。")])])}),[],!1,null,null,null);s.default=n.exports}}]);